# Windows 轻量级沙箱 - 代码实现

## 项目概述

这是一个为Windows操作系统设计的轻量级沙箱系统，用于隔离潜在的恶意软件、测试未知应用程序，同时保护系统关键部分。该沙箱具有极低的资源占用（内存占用低于5%、CPU使用率低于3%），并提供完整的隔离保护功能。

## 核心模块

该沙箱系统由以下核心模块组成：

1. **核心隔离层 (Core Isolation Layer)**
   - 提供基础的进程和内存隔离功能
   - 实现沙箱环境的基本边界

2. **资源控制模块 (Resource Control)**
   - 限制沙箱内进程的资源使用（CPU、内存、磁盘I/O等）
   - 确保沙箱不会过度消耗系统资源

3. **文件系统隔离模块 (Filesystem Isolation)**
   - 实现文件系统虚拟化和重定向
   - 保护主机文件系统不被沙箱内程序修改

4. **注册表保护模块 (Registry Isolation)**
   - 实现注册表虚拟化和重定向
   - 防止沙箱内程序修改系统注册表

5. **守护进程模块 (Daemon Guard)**
   - 防止沙箱被恶意程序关闭
   - 提供自我保护和恢复机制

6. **用户界面模块 (User Interface)**
   - 提供直观的图形界面
   - 方便用户管理沙箱

## 文件结构

```
/
├── core_isolation_layer.cpp  - 核心隔离层实现
├── resource_control.h        - 资源控制模块接口
├── resource_control.cpp      - 资源控制模块实现
├── filesystem_isolation.h    - 文件系统隔离模块接口
├── filesystem_isolation.cpp  - 文件系统隔离模块实现
├── registry_isolation.h      - 注册表保护模块接口
├── registry_isolation.cpp    - 注册表保护模块实现
├── daemon_guard.h            - 守护进程模块接口
├── daemon_guard.cpp          - 守护进程模块实现
├── user_interface.h          - 用户界面模块接口
└── user_interface.cpp        - 用户界面模块实现
```

## 编译说明

该项目需要使用Visual Studio 2019或更高版本进行编译，并且需要Windows SDK 10.0.19041.0或更高版本。

1. 创建一个新的Visual Studio C++项目
2. 将所有源文件添加到项目中
3. 确保项目设置中包含以下库：
   - User32.lib
   - Advapi32.lib
   - Shell32.lib
   - Comctl32.lib
   - Shlwapi.lib
4. 编译项目

## 使用说明

1. 运行编译后的可执行文件
2. 通过用户界面创建新的沙箱
3. 配置沙箱参数（资源限制、隔离级别等）
4. 启动沙箱
5. 在沙箱中运行应用程序

## 注意事项

- 该沙箱系统需要管理员权限才能正常运行
- 某些功能（如驱动级保护）需要安装和加载内核驱动
- 为获得最佳性能，建议在具有至少4GB内存和多核处理器的系统上运行

## 扩展功能

该沙箱系统可以通过以下方式进行扩展：

1. 添加网络隔离模块
2. 实现更细粒度的权限控制
3. 添加应用程序白名单/黑名单功能
4. 集成威胁检测和分析功能

## 许可证

该项目代码仅供学习和研究使用。
